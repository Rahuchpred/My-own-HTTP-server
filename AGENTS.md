# AGENTS.md

## Cursor Cloud specific instructions

### Overview

This is a custom HTTP/1.1 server built from scratch in Python using raw TCP sockets (no frameworks). It has zero runtime dependencies — only Python stdlib. Dev dependencies are `pytest` and `ruff`, listed in `requirements-dev.txt`.

### Running the server

Start in plain HTTP mode (recommended for local dev/testing):

```bash
python3 server.py --host 127.0.0.1 --port 8080
```

For TLS mode, use the wrapper script which auto-generates self-signed certs:

```bash
scripts/start_server.sh
```

The server binds to `127.0.0.1:8080` (HTTP) or `127.0.0.1:8443` (TLS). See `README.md` for the full CLI options.

### Lint, test, build

- **Lint:** `python3 -m ruff check .`
- **Test:** `python3 -m pytest -q`
- **No build step** — the server runs directly from source.

These are also documented in the README under "Automated Checks".

### Non-obvious caveats

- The test suite starts and stops server instances internally on various ports (see `tests/`). No external server process needs to be running for tests.
- `pip install` on this VM installs to `~/.local/bin` (user install). Ensure `$HOME/.local/bin` is on `PATH` or use `python3 -m pytest` / `python3 -m ruff` invocations.
- The server persists state to `data/server_state.json`, `data/scenarios_state.json`, and `data/targets_state.json`. These files are created automatically on first run.
- TLS cert generation requires `openssl` (already available on the VM). Certs are auto-generated by `scripts/start_server.sh` if missing.
